/* Copyright 2021 Simon S.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
#include QMK_KEYBOARD_H
#include <stdio.h>

// Defines names for use in layer keycodes and the keymap
enum layer_names
{
	_one = 0,
	_two,
};

enum custom_keycodes {
    toggle_layer = SAFE_RANGE,
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
    /* Base */
[_one] = LAYOUT(
        KC_TRNS, KC_TRNS, KC_H,
        toggle_layer, KC_1, KC_2,
        KC_MEDIA_PREV_TRACK, KC_MEDIA_PLAY_PAUSE, KC_MEDIA_NEXT_TRACK),
		
[_two] = LAYOUT(
        KC_TRNS, KC_TRNS, KC_I,
        toggle_layer, KC_A, KC_B,
        KC_C, KC_D, KC_E),
};

bool layer2 = false;

bool encoder_update_user(uint8_t index, bool clockwise)
{
    if (clockwise) {
        tap_code16(KC_A);
    } else {
        tap_code16(KC_B);
    }
	
    return true;
}
  static const char PROGMEM my_logo1[] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x80, 0xc0, 0x60, 0x60, 0x20, 0x30, 0x10, 0x18, 0x18, 0x0c, 0x06, 0x03, 0x03, 0x07, 
0x1c, 0x18, 0x10, 0x30, 0x30, 0x20, 0x60, 0x60, 0xc0, 0xc0, 0xc0, 0x80, 0x80, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa0, 0xf8, 0x7c, 0x06, 0xd6, 0xe6, 0x1c, 0x0c, 0x3c, 0x3c, 
0x06, 0x03, 0x03, 0x01, 0x00, 0x80, 0xc0, 0xe0, 0xc0, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x03, 0x03, 0x03, 0x06, 0x06, 
0x0c, 0x08, 0x18, 0x18, 0x18, 0x08, 0x0c, 0x8c, 0xfe, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0xe4, 0xa4, 0xfe, 0xbe, 0xe6, 0x66, 0x7e, 0xf6, 0x26, 
0xb6, 0xfe, 0xae, 0xe2, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x02, 0x02, 
0x02, 0x02, 0x04, 0x02, 0x04, 0x04, 0x0d, 0x07, 0x1e, 0x0c, 0x1c, 0x1c, 0x18, 0x38, 0x38, 0x30, 
0x30, 0x60, 0x60, 0x60, 0x60, 0xc0, 0xc1, 0xc1, 0xc0, 0x80, 0x83, 0x83, 0x83, 0x87, 0x07, 0x0e, 
0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x7c, 0x38, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x7f, 0xe3, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa0, 0xa2, 0xb3, 0x99, 0x99, 255, 0xee, 0x6a, 0x6a, 0xfb, 
0xdb, 0x88, 0x81, 0x83, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x03, 0x03, 
0x03, 0x03, 0x03, 0x06, 0x06, 0x0e, 0x7c, 0xee, 0x83, 0x80, 0x80, 0x80, 0x80, 0xc0, 0xc0, 0x40, 
0x70, 0x70, 0x70, 0x70, 0x70, 0x60, 0xc0, 0xc0, 0xc1, 0xc7, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
  };
void render_logo1(void) {


  oled_write_raw_P(my_logo1, sizeof(my_logo1));
}

void render_logo2(void) {
 /* static const char PROGMEM my_logo2[] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x80, 0xc0, 0xc0, 0x60, 0x60, 0x30, 0x10, 0x18, 0x18, 0x0c, 0x0c, 0x07, 0x03, 0x03, 0x06, 
0x1c, 0x18, 0x30, 0x30, 0x20, 0x60, 0x60, 0x40, 0xc0, 0xc0, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x40, 0x70, 0x30, 0x18, 0x0c, 0x06, 
0x03, 0x03, 0x01, 0x00, 0x00, 0xc0, 0xc0, 0xc0, 0x40, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x03, 0x03, 0x03, 0x06, 0x04, 
0x0c, 0x08, 0x18, 0x18, 0x08, 0x0c, 0x0c, 0xc6, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0xe4, 0xa4, 0xfe, 0xbe, 0xe6, 0x66, 0x7e, 0xf6, 0x26, 
0xb6, 0xfe, 0xae, 0xe2, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x02, 0x02, 
0x02, 0x02, 0x84, 0x82, 0x84, 0x6c, 0xfc, 0x8e, 0x03, 0x81, 0x00, 0x80, 0x80, 0x80, 0x80, 0xc0, 
0x40, 0x40, 0x60, 0x60, 0x60, 0xc0, 0xc1, 0xc1, 0xc0, 0x81, 0x83, 0x83, 0x83, 0x87, 0x06, 0x06, 
0x04, 0x00, 0x00, 0x00, 0x00, 0x10, 0x38, 0x3c, 0x78, 0xfc, 0xbe, 0x46, 0x9f, 0xc7, 0xa6, 0x1e, 
0x1e, 0x38, 0x20, 0x00, 0x00, 0x00, 0x3e, 0x7f, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa0, 0xa2, 0xb3, 0x99, 0x99, 0xff, 0xee, 0x6a, 0x6a, 0xfb, 
0xdb, 0x88, 0x81, 0x83, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x01, 0x05, 0x06, 0x00, 0x00, 0x01, 0x09, 0x1d, 0x09, 0x01, 0x01, 0x01, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x03, 0x03, 
0x03, 0x03, 0x03, 0x06, 0x06, 0x06, 0x04, 0x0c, 0x0d, 0x0f, 0x0e, 0x0c, 0x18, 0x18, 0x38, 0x38, 
0x30, 0x30, 0x70, 0x70, 0x60, 0x60, 0xc0, 0xc0, 0xc3, 0xdf, 0xfc, 0xe0, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
  };*/
    static const char PROGMEM my_logo2[] = {
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,192,192,96,96,48,16,24,24,12,12,7,3,3,6,28,24,48,48,32,96,96,64,192,192,128,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,128,128,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,64,112,48,24,12,6,3,3,1,0,0,192,192,192,64,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,3,3,6,4,12,8,24,24,8,12,12,198,254,0,0,0,0,0,0,0,0,0,0,0,0,0,96,228,164,254,190,230,102,126,246,38,182,254,174,226,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,132,130,132,108,252,142,3,129,0,128,128,128,128,192,64,64,96,96,96,192,193,193,192,129,131,131,131,135,6,6,4,0,0,0,0,16,56,60,120,252,190,70,159,199,166,30,30,56,32,0,0,0,62,127,192,0,0,0,0,0,0,0,0,0,0,0,0,0,160,162,179,153,153,255,238,106,106,251,219,136,129,131,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,6,0,0,1,9,29,9,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,3,3,3,3,3,6,6,6,4,12,13,15,14,12,24,24,56,56,48,48,112,112,96,96,192,192,195,223,252,224,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0
  };

  oled_write_raw_P(my_logo2, sizeof(my_logo2));
}

bool pic1 = true;
int i = 0;
int receives = 0;
uint8_t uCharArray[12288];
char charArray[12288];

#ifdef OLED_ENABLE
bool oled_task_user(void)
{
	oled_write_P(PSTR("Test\n"), false);
	/*
	//pic1 = !pic!;
	i++;
	if(i > 350) {
		//pic1 = !pic1;
		i = 0;
	}
	//
	//if(pic1)
	//	render_logo1();
	//else 
	//	render_logo2();
	//}
	oled_write_P(PSTR("Test\n"), false);
	//oled_write_P(PSTR("\n"), false);
	for(int q  = 0; q != 100; q++) {
		//oled_write_char(charArray[q], false);
	}
	//oled_write_char(my_logo1[0], false);
	long quotient, remainder;
	long decimalnum = 255;
    int i, j = 0;
    char hexadecimalnum[100];
    quotient = decimalnum;
 
    while (quotient != 0)
    {
        remainder = quotient % 16;
        if (remainder < 10)
            hexadecimalnum[j++] = 48 + remainder;
        else
            hexadecimalnum[j++] = 55 + remainder;
        quotient = quotient / 16;
    }
 
    // display integer into character
	//char
    for (i = j; i >= 0; i--) {
		oled_write_char(hexadecimalnum[i], false);
	}
	
	char *arr[] = {"255"};

    size_t len = sizeof arr / sizeof arr[0];
    long int arr3[len];
    for (int i = 0; i < len; ++i) {
        arr3[i] = strtol(arr[i], NULL, 10);
    }
	char cc = arr3[0];
	if(arr3[0] == 255) 
		oled_write_P(PSTR("255"), false);
	oled_write_char(cc, false);
	*/
	return true;
}
#endif

int getIntFromString(char* text) {
	return strtol(text, NULL, 10);
}

#ifdef VIRTSER_ENABLE
int intss[4096];
char* cpArray[12288];
int kommasFound = 0;
void virtser_recv(const uint8_t ch)  {
	uCharArray[receives] = ch;
	charArray[receives] = ch;
	receives++;
	//char cc[3];
	/*for(int v = 0; v < 12288; v++) {
		if(charArray[v] == ',') {
			
			char cc[3] = {charArray[v] - 3, charArray[v] - 2, charArray[v] - 1};
			char* cp = &cc[0];
			cpArray[kommasFound] = cp;
			
			kommasFound++;
		}
	}
	*/
	//if(getIntFromString(cpArray[0]) == 123) {
		oled_write_P(PSTR("123!!!"), false);
	//}
	//oled_write_char(ch, false);
	//render_logo2();
}
#endif




